<div class="entry-content">
<p>100円で買った（<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%C0%A5%A4%A5%BD%A1%BC">ダイソー</a>）照度センサーで点灯する常夜灯があるのだが、<br/>
朝も昼も夜もほぼ常時点灯になっていた。</p><p>これを感度調整して、適切に消点灯させたい。</p><p><span itemscope="" itemtype="http://schema.org/Photograph"><img alt="f:id:s51517765:20161225173525j:plain" class="hatena-fotolife" itemprop="image" src="https://cdn-ak.f.st-hatena.com/images/fotolife/s/s51517765/20161225/20161225173525.jpg" title="f:id:s51517765:20161225173525j:plain"/></span></p><p>カバーをあけてみると思いのほか部品が多い。<br/>
<span itemscope="" itemtype="http://schema.org/Photograph"><img alt="f:id:s51517765:20161225173446j:plain" class="hatena-fotolife" itemprop="image" src="https://cdn-ak.f.st-hatena.com/images/fotolife/s/s51517765/20161225/20161225173446.jpg" title="f:id:s51517765:20161225173446j:plain"/></span></p><p><span itemscope="" itemtype="http://schema.org/Photograph"><img alt="f:id:s51517765:20161225173556j:plain" class="hatena-fotolife" itemprop="image" src="https://cdn-ak.f.st-hatena.com/images/fotolife/s/s51517765/20161225/20161225173556.jpg" title="f:id:s51517765:20161225173556j:plain"/></span></p><p>100VACからLEDの点灯の2VDCを得ることが一番の目的で、照度センサ（<a class="keyword" href="http://d.hatena.ne.jp/keyword/CDS">CDS</a>）で<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%C8%A5%E9%A5%F3%A5%B8%A5%B9%A5%BF">トランジスタ</a>を制御し、ON/OFFとなるようにしているようだ。</p><p><span itemscope="" itemtype="http://schema.org/Photograph"><img alt="f:id:s51517765:20161225173612j:plain" class="hatena-fotolife" itemprop="image" src="https://cdn-ak.f.st-hatena.com/images/fotolife/s/s51517765/20161225/20161225173612.jpg" title="f:id:s51517765:20161225173612j:plain"/></span></p><p><span itemscope="" itemtype="http://schema.org/Photograph"><img alt="f:id:s51517765:20161225173603j:plain" class="hatena-fotolife" itemprop="image" src="https://cdn-ak.f.st-hatena.com/images/fotolife/s/s51517765/20161225/20161225173603.jpg" title="f:id:s51517765:20161225173603j:plain"/></span></p><p>すでに先人が分解した記録がるのでこれを参考に、回路を推定した。<br/>
本当はプリント基板を解読すれば解るのだが、2面（両面）基板のため、素人には解読が難しかった。<br/>
<iframe class="embed-card embed-webcard" frameborder="0" scrolling="no" src="//hatenablog-parts.com/embed?url=https%3A%2F%2Fsites.google.com%2Fsite%2Fhirojp123456%2Fhome%2Fledjouyatou-kaizou" style="display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;" title="LED常夜灯改造 - hirojp123456"></iframe><cite class="hatena-citation"><a href="https://sites.google.com/site/hirojp123456/home/ledjouyatou-kaizou">sites.google.com</a></cite></p><p>推定回路が↓のような感じではないかと<br/>
<span itemscope="" itemtype="http://schema.org/Photograph"><img alt="f:id:s51517765:20161225182218p:plain" class="hatena-fotolife" itemprop="image" src="https://cdn-ak.f.st-hatena.com/images/fotolife/s/s51517765/20161225/20161225182218.png" title="f:id:s51517765:20161225182218p:plain"/></span></p><p>オレンジで囲んだ部分が、突入電流回避回路。<br/>
交流であり、しかも100Vであり、LEDにとっては大きな電圧なので、<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%B3%A5%F3%A5%C7%A5%F3%A5%B5">コンデンサ</a>を入れることでこれを軽減できる。<br/>
抵抗は実測していないが、引用先よりこれぐらいの大きさかと。</p><p>赤で囲んだ部分がブリッジ<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%C0%A5%A4%A5%AA%A1%BC%A5%C9">ダイオード</a>といって、交流からLED点灯用の直流を得る回路である。<br/>
<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%C0%A5%A4%A5%AA%A1%BC%A5%C9">ダイオード</a>は決まった向きにしか電流を流さないことから、整流回路ともいう。</p><p>AC電源なので、電源端子は+と-が入れ替わる。<br/>
プラスはまあいいとしても、マイナスがくると困る。<br/>
なので、マイナスのときは回路を入れ替えて電流を欲しい向きに誘導してやるようなイメージである。</p><p>たとえば、回路図の上側の電源端子が+であるときは、上側端子　→　D1　→　LED　→　D2　→下側端子という風に流れる。<br/>
一方、回路図の下側が　+であるときは、　下側端子　→　D4　→　LED　→　D3　→　上側端子という風に流れる。<br/>
（<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%C0%A5%A4%A5%AA%A1%BC%A5%C9">ダイオード</a>は反対極性の電流にたいしては絶縁のように振舞う）</p><p>そして、<a class="keyword" href="http://d.hatena.ne.jp/keyword/CDS">CDS</a>をつかったON/Off回路は、<a class="keyword" href="http://d.hatena.ne.jp/keyword/CDS">CDS</a>は明るいとき抵抗が低く暗いとき抵抗が高い。<br/>
これが逆の特性を持っていれば、LEDに直列につないだ単純な回路でOn/Offが実現できるのだが、現実は不幸にも逆だ。</p><p>そこで、LEDをNPN<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%C8%A5%E9%A5%F3%A5%B8%A5%B9%A5%BF">トランジスタ</a>で駆動することを考える。<br/>
NPNのベース電圧を<a class="keyword" href="http://d.hatena.ne.jp/keyword/CDS">CDS</a>とR1で分圧し、<a class="keyword" href="http://d.hatena.ne.jp/keyword/CDS">CDS</a>の抵抗が高くなる（暗くなる）とベースがhighになってLEDを駆動すればよい。</p><p><span itemscope="" itemtype="http://schema.org/Photograph"><img alt="f:id:s51517765:20161225184600j:plain" class="hatena-fotolife" itemprop="image" src="https://cdn-ak.f.st-hatena.com/images/fotolife/s/s51517765/20161225/20161225184600.jpg" title="f:id:s51517765:20161225184600j:plain"/></span><br/>
<a class="keyword" href="http://d.hatena.ne.jp/keyword/CDS">CDS</a>に光を当てながらテスターで抵抗を測り、また、LEDのOn/offと光の強さを観測すると、大体40kΩ以上となったときLEDが点灯することを突き止めた。<br/>
しかしながら、通常使用している環境では<a class="keyword" href="http://d.hatena.ne.jp/keyword/CDS">CDS</a>はつねに40kΩ以上であった。<br/>
つまりグラフでいうと、<a class="keyword" href="http://d.hatena.ne.jp/keyword/CDS">CDS</a>の青線において、40kΩを境にした右上の領域しか実現しないのである。</p><p><a class="keyword" href="http://d.hatena.ne.jp/keyword/CDS">CDS</a>はこの40kΩ以上であるが、合成抵抗で40kΩの前後を動くようにしてやればよい。<br/>
そこで、回路図の水色のように100kΩの抵抗を<a class="keyword" href="http://d.hatena.ne.jp/keyword/CDS">CDS</a>に並列に接続すると、合成抵抗は赤線のようになる。<br/>
カバーをあけた状態ではんだ付けができるので、↓のようにつけた。<br/>
<span itemscope="" itemtype="http://schema.org/Photograph"><img alt="f:id:s51517765:20161225185446j:plain" class="hatena-fotolife" itemprop="image" src="https://cdn-ak.f.st-hatena.com/images/fotolife/s/s51517765/20161225/20161225185446.jpg" title="f:id:s51517765:20161225185446j:plain"/></span></p><p>このようにすると、<a class="keyword" href="http://d.hatena.ne.jp/keyword/CDS">CDS</a>は40kΩ以上なのだが、合成抵抗が40kΩの前後を動くようになる。<br/>
並列の合成抵抗の計算は　（A * B) / (A+ B)Ωであるので<br/>
(<a class="keyword" href="http://d.hatena.ne.jp/keyword/CDS">CDS</a> * 100k)　/ (<a class="keyword" href="http://d.hatena.ne.jp/keyword/CDS">CDS</a> + 100k)Ω　として、<a class="keyword" href="http://d.hatena.ne.jp/keyword/CDS">CDS</a>の抵抗に対しプロットした。<br/>
　<br/>
ちなみに、<a class="keyword" href="http://d.hatena.ne.jp/keyword/%C0%C4%BF%A7LED">青色LED</a>が煌々と煌くのもいまいちなので、黄色LEDに変えた。</p><p>完成。</p>
</div>