<div class="entry-content">
<p><iframe class="embed-card embed-blogcard" frameborder="0" scrolling="no" src="https://hatenablog-parts.com/embed?url=https%3A%2F%2Fs51517765.hatenadiary.jp%2Fentry%2F2020%2F02%2F25%2F073000" style="display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;" title="C#で画像処理アプリを作った - プログラミング素人のはてなブログ"></iframe><cite class="hatena-citation"><a href="https://s51517765.hatenadiary.jp/entry/2020/02/25/073000">s51517765.hatenadiary.jp</a></cite><br/>
<iframe class="embed-card embed-blogcard" frameborder="0" scrolling="no" src="https://hatenablog-parts.com/embed?url=https%3A%2F%2Fs51517765.hatenadiary.jp%2Fentry%2F2020%2F04%2F06%2F073000" style="display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;" title="C#で作った画像処理アプリを改良した - プログラミング素人のはてなブログ"></iframe><cite class="hatena-citation"><a href="https://s51517765.hatenadiary.jp/entry/2020/04/06/073000">s51517765.hatenadiary.jp</a></cite><br/>
<iframe class="embed-card embed-blogcard" frameborder="0" scrolling="no" src="https://hatenablog-parts.com/embed?url=https%3A%2F%2Fs51517765.hatenadiary.jp%2Fentry%2F2020%2F08%2F10%2F073000" style="display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;" title="C#で画像にぼかしをいれる - プログラミング素人のはてなブログ"></iframe><cite class="hatena-citation"><a href="https://s51517765.hatenadiary.jp/entry/2020/08/10/073000">s51517765.hatenadiary.jp</a></cite></p><p>自作の画像処理ソフト「EasyRetouch」ですが、これまでは画像サイズを一律に900 x 900px以下に縮小していました。<br/>
これはもともと編集内容がPC画面内で表示できるサイズ、を基準としていました。<br/>
しかし、画像によってはもう少し解像度がほしい、という場合があり出力画像サイズを可変にできるようにしました。</p><p>画像サイズの変更は以下のようにすることで出来ます。</p>
<pre class="code lang-cs" data-lang="cs" data-unlink="">canvas2 = <span class="synStatement">new</span> Bitmap(canvas0, (<span class="synType">int</span>)(Size-X), (<span class="synType">int</span>)(Size-Y));
canvas2.Save(FileName);
</pre><p>縮小するときはこれでいいのですが、この関数で拡大した場合は当然画質が荒くなってしまいます。<br/>
もともと、<a class="keyword" href="http://d.hatena.ne.jp/keyword/Canvas">Canvas</a>を等倍でpictureBoxに表示ししながら画像を編集していましたが、表示した画像を最後に画質を上げる、ということはできません。(<a class="keyword" href="http://d.hatena.ne.jp/keyword/%C9%D4%B2%C4%B5%D5%B0%B5%BD%CC">不可逆圧縮</a>のため)<br/>
つまり、最終的に必要な画質（解像度）は編集中にそれ以上の解像度を保っていなければなりません。<br/>
しかしながら、それではPCの画面からはみ出してしまうので編集には不向きです。（画像の一部分しか表示されないか大きなモニターが必要）</p><p></p><h3>解決策</h3>以下のようにすることで実現できました。<br/>
・画像編集用の大きい<a class="keyword" href="http://d.hatena.ne.jp/keyword/Canvas">Canvas</a>（3600 x 3600 px）を保持<br/>
・PictureBox表示用のCanvas1（900 x 900 px）を<a class="keyword" href="http://d.hatena.ne.jp/keyword/Canvas">Canvas</a>の縮小処理したものとして保持<br/>
・最終出力は<a class="keyword" href="http://d.hatena.ne.jp/keyword/Canvas">Canvas</a>を任意の大きさに縮小した<a class="keyword" href="http://d.hatena.ne.jp/keyword/Canvas2">Canvas2</a>をいったん作成し保存。<p><span itemscope="" itemtype="http://schema.org/Photograph"><img alt="f:id:s51517765:20210306182416p:plain" class="hatena-fotolife" itemprop="image" src="https://cdn-ak.f.st-hatena.com/images/fotolife/s/s51517765/20210306/20210306182416.png" title=""/></span></p><p><iframe class="embed-card embed-webcard" frameborder="0" scrolling="no" src="https://hatenablog-parts.com/embed?url=https%3A%2F%2Fgithub.com%2Fs51517765%2FEasyRetouch" style="display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;" title="s51517765/EasyRetouch"></iframe><cite class="hatena-citation"><a href="https://github.com/s51517765/EasyRetouch">github.com</a></cite></p>
</div>