<div class="entry-content">
<div class="section">
<h3>Windows10のファイル（全文）検索は???</h3>
<p>絶対該当ファイルがあるはずなのに見つからない、ということが多くあります。<br/>
ファイル検索は、<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%A8%A5%AF%A5%B9%A5%D7%A5%ED%A1%BC%A5%E9">エクスプローラ</a>の右上の「ここ」からやりますよね。<br/>
<span itemscope="" itemtype="http://schema.org/Photograph"><img alt="f:id:s51517765:20210703224736p:plain" class="hatena-fotolife" height="677" itemprop="image" loading="lazy" src="https://cdn-ak.f.st-hatena.com/images/fotolife/s/s51517765/20210703/20210703224736.png" title="" width="1200"/></span></p><p>あらかじめインデックスを作成しておけばできるらしいですが、インデックスを作成するのも大変（PCのリソースを使う）なのです。<br/>
どうも、最近使ったファイルに関してはインデックスが作成されるようですが、ほとんどの場合うまくいきません。<br/>
<iframe class="embed-card embed-webcard" frameborder="0" scrolling="no" src="https://hatenablog-parts.com/embed?url=https%3A%2F%2Faprico-media.com%2Fposts%2F6282" style="display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;" title="Windows10でファイルの全文検索を行う方法を紹介！ | Aprico"></iframe><cite class="hatena-citation"><a href="https://aprico-media.com/posts/6282">aprico-media.com</a></cite><br/>
</p>
</div>
<div class="section">
<h3><a class="keyword" href="http://d.hatena.ne.jp/keyword/Powershell">Powershell</a>で検索出来る</h3>
<p>カレントフォルダですべてのファイルを対象に<a class="keyword" href="http://d.hatena.ne.jp/keyword/hoge">hoge</a>で検索</p>
<pre class="code" data-lang="" data-unlink="">$ Select-String -Path * -Pattern 'hoge'</pre><p>指定したファイルの中のみを検索</p>
<pre class="code" data-lang="" data-unlink="">$ Select-String -Path hoge.txt -Pattern 'hoge'</pre><p>ちなみに<code>Select-String</code>は<code>sls</code>という<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%A8%A5%A4%A5%EA%A5%A2%A5%B9">エイリアス</a>があります。</p><p>下位フォルダを含めて<a class="keyword" href="http://d.hatena.ne.jp/keyword/%C1%B4%CA%B8%B8%A1%BA%F7">全文検索</a></p>
<pre class="code" data-lang="" data-unlink="">$ Get-ChildItem -Path ./* -Filter * -Recurse | Select-String -Pattern 'main'</pre><p>OR検索は末尾にキーワードを追加、３つ?以上も可</p>
<pre class="code" data-lang="" data-unlink="">$ Select-String -Path "*.txt" -Pattern "hello","world"</pre><p>AND検索はパイプでつなぐ</p>
<pre class="code" data-lang="" data-unlink="">$  Select-String "hello" *.txt | Select-String "world"</pre><p>キーワードの前後数行を同時に見たいとき</p>
<pre class="code" data-lang="" data-unlink="">$ Select-String -Encoding Default -Path &lt;ファイル名&gt; -Pattern "キーワード" -Context 3,4</pre><p>カレントフォルダの移動は<a class="keyword" href="http://d.hatena.ne.jp/keyword/Linux">Linux</a>と同じです。</p>
<pre class="code" data-lang="" data-unlink="">$ cd ***</pre><p>ファイルパスにスペースなどが含まれる場合はパスを<code>" "</code>で囲みます。</p>
<pre class="code" data-lang="" data-unlink="">$ cd "Users\***\Documents\Visual Studio 2017\Projects"</pre><p>「権限がない」と怒られるときは管理者権限で<a class="keyword" href="http://d.hatena.ne.jp/keyword/Powershell">Powershell</a>を起動します。<br/>
<span itemscope="" itemtype="http://schema.org/Photograph"><img alt="f:id:s51517765:20210703231234j:plain" class="hatena-fotolife" height="1021" itemprop="image" loading="lazy" src="https://cdn-ak.f.st-hatena.com/images/fotolife/s/s51517765/20210703/20210703231234.jpg" title="" width="1199"/></span><br/>
<iframe class="embed-card embed-webcard" frameborder="0" scrolling="no" src="https://hatenablog-parts.com/embed?url=https%3A%2F%2Fpc-karuma.net%2Fwindows-10-powershell%2F" style="display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;" title="Windows10 - PowerShellを起動する方法（管理者も） | PC設定のカルマ"></iframe><cite class="hatena-citation"><a href="https://pc-karuma.net/windows-10-powershell/">pc-karuma.net</a></cite><br/>
</p>
</div>
<div class="section">
<h3>まとめ</h3>
<p>Shellとは<a class="keyword" href="http://d.hatena.ne.jp/keyword/Linux">Linux</a>のターミナルのようなものですが、<a class="keyword" href="http://d.hatena.ne.jp/keyword/Powershell">Powershell</a>は独特の似て非なるものです。<br/>
しかし、このように使えば使える機能もあります。<br/>
私も以前はExcellの<a class="keyword" href="http://d.hatena.ne.jp/keyword/VBA">VBA</a>で<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%B9%A5%AF%A5%EC%A5%A4%A5%D4%A5%F3%A5%B0">スクレイピング</a>をしていたこともありましたが「ちょっと使う」には<a class="keyword" href="http://d.hatena.ne.jp/keyword/Powershell">Powershell</a>が便利です。</p>
</div>
<div class="section">
<h3>参考</h3>
<p><iframe class="embed-card embed-webcard" frameborder="0" scrolling="no" src="https://hatenablog-parts.com/embed?url=http%3A%2F%2Fyanor.net%2Fwiki%2F%3FPowerShell%252F%25E3%2582%25B3%25E3%2583%259E%25E3%2583%25B3%25E3%2583%2589%25E3%2583%25AC%25E3%2583%2583%25E3%2583%2588%252F%25E6%2596%2587%25E5%25AD%2597%25E5%2588%2597%25E3%2583%25BB%25E3%2583%2595%25E3%2582%25A1%25E3%2582%25A4%25E3%2583%25AB%25E3%2581%25AE%25E3%2583%2586%25E3%2582%25AD%25E3%2582%25B9%25E3%2583%2588%25E6%25A4%259C%25E7%25B4%25A2%2520-%2520%2520Select-String" style="display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;" title="PowerShell/コマンドレット/文字列・ファイルのテキスト検索 - Select-String - yanor.net/wiki"></iframe><cite class="hatena-citation"><a href="http://yanor.net/wiki/?PowerShell%2F%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%83%AC%E3%83%83%E3%83%88%2F%E6%96%87%E5%AD%97%E5%88%97%E3%83%BB%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E6%A4%9C%E7%B4%A2%20-%20%20Select-String">yanor.net</a></cite><br/>
<iframe class="embed-card embed-webcard" frameborder="0" scrolling="no" src="https://hatenablog-parts.com/embed?url=https%3A%2F%2Fwin.just4fun.biz%2F%3FPowerShell%2FSelect-String%25E3%2581%25A7%25E6%25A4%259C%25E7%25B4%25A2%25E3%2581%2597%25E3%2581%259F%25E5%2589%258D%25E5%25BE%258C%25E3%2581%25AE%25E8%25A1%258C%25E3%2582%2592%25E8%25A1%25A8%25E7%25A4%25BA%25E3%2581%2599%25E3%2582%258B%25E6%2596%25B9%25E6%25B3%2595" style="display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;" title="PowerShell/Select-Stringで検索した前後の行を表示する方法 - Windowsと暮らす"></iframe><cite class="hatena-citation"><a href="https://win.just4fun.biz/?PowerShell/Select-String%E3%81%A7%E6%A4%9C%E7%B4%A2%E3%81%97%E3%81%9F%E5%89%8D%E5%BE%8C%E3%81%AE%E8%A1%8C%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95">win.just4fun.biz</a></cite></p>
</div>
</div>